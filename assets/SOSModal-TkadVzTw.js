import{r as n,j as e,A as S,m as a,H as C,X as I,a as B}from"./index-J6Tnmq39.js";import{A as E}from"./arrow-right-C_64sUb2.js";const m=[{phase:"inhale",duration:4e3,label:"Inspirez",emoji:"ðŸŒ¬ï¸"},{phase:"hold",duration:4e3,label:"Retenez",emoji:"âœ¨"},{phase:"exhale",duration:6e3,label:"Expirez",emoji:"ðŸƒ"},{phase:"pause",duration:2e3,label:"Pause",emoji:"ðŸ’«"}];function z({isOpen:r,onClose:b,positiveItems:T}){const[i,l]=n.useState("welcome"),[o,u]=n.useState("inhale"),[c,h]=n.useState(0),[d,p]=n.useState(0),f=3;n.useEffect(()=>{r&&(l("welcome"),h(0),u("inhale"),p(0))},[r]),n.useEffect(()=>{if(!r||i!=="breathing")return;let t=0,s=0,x,y;const N=()=>{const w=m[t];u(w.phase),y=Date.now();const k=()=>{const A=Date.now()-y,P=Math.min(A/w.duration,1);if(p(P),P<1)x=requestAnimationFrame(k);else{if(t++,t>=m.length&&(t=0,s++,h(s),s>=f)){l("positives");return}N()}};x=requestAnimationFrame(k)};return N(),()=>{x&&cancelAnimationFrame(x)}},[r,i]);const j=[...T].sort(()=>Math.random()-.5).slice(0,5),v=m.find(t=>t.phase===o)||m[0],g=()=>{switch(o){case"inhale":return 1+d*.4;case"hold":return 1.4;case"exhale":return 1.4-d*.4;case"pause":return 1;default:return 1}};return e.jsx(S,{children:r&&e.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-50 flex flex-col bg-[var(--bg)]",style:{paddingTop:"env(safe-area-inset-top)"},children:[e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-[var(--terra)] flex items-center justify-center",children:e.jsx(C,{className:"w-4 h-4 text-[var(--bg)]"})}),e.jsx("span",{className:"font-semibold text-[var(--ink)]",children:"Mode SOS"})]}),e.jsx(a.button,{whileTap:{scale:.9},onClick:b,className:"w-10 h-10 rounded-xl bg-[var(--sand)] flex items-center justify-center",children:e.jsx(I,{className:"w-5 h-5 text-[var(--ink-muted)]"})})]}),e.jsx("div",{className:"px-5 pb-4",children:e.jsx("div",{className:"flex gap-2",children:["welcome","breathing","positives","complete"].map((t,s)=>e.jsx("div",{className:"flex-1 h-1 rounded-full overflow-hidden bg-[var(--sand)]",children:e.jsx(a.div,{initial:{width:0},animate:{width:i===t?"50%":["welcome","breathing","positives","complete"].indexOf(i)>s?"100%":"0%"},transition:{duration:.3},className:"h-full bg-[var(--sage)]"})},t))})}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-6 overflow-hidden",children:e.jsxs(S,{mode:"wait",children:[i==="welcome"&&e.jsxs(a.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.35,ease:"easeOut"},className:"text-center w-full max-w-sm",children:[e.jsx(a.div,{animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:2.5,ease:"easeInOut"},className:"w-24 h-24 mx-auto mb-8 rounded-3xl bg-[var(--terra)] flex items-center justify-center shadow-lg",style:{boxShadow:"0 8px 32px rgba(224, 122, 95, 0.3)"},children:e.jsx(C,{className:"w-12 h-12 text-[var(--bg)]"})}),e.jsx("h2",{className:"font-serif text-[28px] font-bold text-[var(--ink)] mb-3",children:"Tout va bien aller"}),e.jsx("p",{className:"text-[var(--ink-muted)] text-[17px] mb-10 max-w-[280px] mx-auto leading-relaxed",children:"Prenons un moment ensemble pour respirer et nous recentrer."}),e.jsxs(a.button,{whileTap:{scale:.97},onClick:()=>l("breathing"),className:"w-full py-4 bg-[var(--ink)] text-[var(--bg)] font-semibold text-[17px] rounded-2xl flex items-center justify-center gap-2.5 shadow-lg",children:[e.jsx("span",{children:"Commencer"}),e.jsx(E,{className:"w-5 h-5"})]}),e.jsx("p",{className:"text-[var(--ink-faint)] text-sm mt-4",children:"~ 2 minutes de respiration guidÃ©e"})]},"welcome"),i==="breathing"&&e.jsxs(a.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.35,ease:"easeOut"},className:"text-center w-full",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-10",children:[Array.from({length:f}).map((t,s)=>e.jsx(a.div,{animate:{scale:s===c?1.3:1,backgroundColor:s<c||s===c?"var(--sage)":"var(--sand)"},className:"w-3 h-3 rounded-full"},s)),e.jsxs("span",{className:"text-[var(--ink-muted)] text-sm ml-2 tabular-nums",children:[c+1,"/",f]})]}),e.jsxs("div",{className:"relative w-56 h-56 mx-auto mb-10",children:[e.jsx(a.div,{animate:{scale:g()},transition:{duration:.1,ease:"linear"},className:"absolute inset-0 rounded-full bg-[var(--sage)] opacity-20"}),e.jsx(a.div,{animate:{scale:g()},transition:{duration:.1,ease:"linear"},className:"absolute inset-5 rounded-full bg-[var(--sage)] flex items-center justify-center shadow-xl",children:e.jsx(a.span,{initial:{scale:.7,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.2},className:"text-5xl",children:v.emoji},o)}),e.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[e.jsx("circle",{cx:"50%",cy:"50%",r:"48%",fill:"none",className:"stroke-[var(--border-strong)]",strokeWidth:"3"}),e.jsx(a.circle,{cx:"50%",cy:"50%",r:"48%",fill:"none",className:"stroke-[var(--sage)]",strokeWidth:"3",strokeLinecap:"round",strokeDasharray:`${2*Math.PI*48}`,animate:{strokeDashoffset:`${2*Math.PI*48*(1-d)}`},transition:{duration:.1,ease:"linear"}})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsx("h2",{className:"font-serif text-3xl font-bold text-[var(--ink)] mb-2",children:v.label}),e.jsxs("p",{className:"text-[var(--ink-muted)] text-xl tabular-nums",children:[Math.ceil((1-d)*(v.duration/1e3)),"s"]})]},o)]},"breathing"),i==="positives"&&e.jsxs(a.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.35,ease:"easeOut"},className:"text-center w-full max-w-sm",children:[e.jsx(a.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20},className:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-[var(--sage)] flex items-center justify-center shadow-lg",children:e.jsx(B,{className:"w-9 h-9 text-[var(--bg)]"})}),e.jsx("h2",{className:"font-serif text-2xl font-bold text-[var(--ink)] mb-2",children:"Bien jouÃ© ! ðŸŽ‰"}),e.jsx("p",{className:"text-[var(--ink-muted)] text-[17px] mb-6",children:"Rappelons-nous du positif"}),e.jsx("div",{className:"space-y-3 mb-8 max-h-[38vh] overflow-y-auto px-1",children:j.length>0?j.map((t,s)=>e.jsx(a.div,{initial:{opacity:0,x:-16},animate:{opacity:1,x:0},transition:{delay:s*.1},className:"bg-[var(--card)] rounded-2xl p-4 text-left border border-[var(--border)] shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-[var(--sage)] flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-[var(--bg)] text-xs",children:"âœ“"})}),e.jsx("p",{className:"text-[var(--ink)] text-[15px] leading-relaxed",children:t.text})]})},t.id)):e.jsxs("div",{className:"bg-[var(--card)] rounded-2xl p-5 border border-[var(--border)]",children:[e.jsx("p",{className:"text-[var(--ink-muted)] text-center text-[15px]",children:"Tu n'as pas encore ajoutÃ© d'Ã©lÃ©ments positifs."}),e.jsx("p",{className:"text-[var(--sage)] text-center text-sm mt-2 font-medium",children:"C'est le moment parfait pour commencer ! ðŸŒ±"})]})}),e.jsx(a.button,{whileTap:{scale:.97},onClick:()=>l("complete"),className:"w-full py-4 bg-[var(--sage)] text-[var(--bg)] font-semibold text-[17px] rounded-2xl shadow-lg",children:"Je me sens mieux ðŸ’ª"})]},"positives"),i==="complete"&&e.jsxs(a.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:25},className:"text-center w-full max-w-sm",children:[e.jsx(a.div,{animate:{y:[0,-8,0],rotate:[0,5,-5,0]},transition:{repeat:1/0,duration:3,ease:"easeInOut"},className:"text-7xl mb-8",children:"ðŸŒ»"}),e.jsx("h2",{className:"font-serif text-[28px] font-bold text-[var(--ink)] mb-3",children:"Tu es incroyable !"}),e.jsxs("p",{className:"text-[var(--ink-muted)] text-[17px] mb-10 leading-relaxed",children:["Continue comme Ã§a, un jour Ã  la fois.",e.jsx("br",{}),"Tu gÃ¨res ! ðŸ’›"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(a.button,{whileTap:{scale:.97},onClick:b,className:"w-full py-4 bg-[var(--ink)] text-[var(--bg)] font-semibold text-[17px] rounded-2xl shadow-lg",children:"Retour Ã  l'app"}),e.jsx("button",{onClick:()=>{h(0),u("inhale"),p(0),l("breathing")},className:"w-full py-3 text-[var(--ink-muted)] font-medium text-[15px] rounded-xl hover:bg-[var(--sand)] transition-colors",children:"Refaire une session"})]})]},"complete")]})}),e.jsx("div",{className:"h-6",style:{paddingBottom:"env(safe-area-inset-bottom)"}})]})})}export{z as SOSModal};
