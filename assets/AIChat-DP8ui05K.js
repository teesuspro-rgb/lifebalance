import{c as C,r as n,u as B,j as e,C as I,S as P,m as d,B as j,a as E}from"./index-BBHOSGGD.js";import{Z as W}from"./zap-C5J4b5PO.js";import{U as z}from"./user-SZ7tPdId.js";const S=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],$=C("wind",S),R=[{icon:"üí¨",text:"Comment aller mieux aujourd'hui ?"},{icon:"üéØ",text:"Aide-moi √† relativiser"},{icon:"üí™",text:"Donne-moi de la motivation"},{icon:"üòå",text:"Comment g√©rer mon stress ?"}],q={hidden:{opacity:0,y:15,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:400,damping:30}}},A=n.memo(function({content:t}){const r=t.split(`
`);return e.jsx("div",{className:"space-y-1.5",children:r.map((s,i)=>{const l=s.trim();if(!l)return e.jsx("div",{className:"h-2"},i);const h=/^\d+\./.test(l),c=l.startsWith("- ")||l.startsWith("‚Ä¢ "),m=x=>x.split(/(\*\*.*?\*\*)/g).map((p,b)=>p.startsWith("**")&&p.endsWith("**")?e.jsx("strong",{className:"font-bold text-[var(--ink)]",children:p.slice(2,-2)},b):p);if(h){const[x,...u]=l.split(".");return e.jsxs("div",{className:"flex gap-2.5 pl-1 my-1",children:[e.jsx("span",{className:"flex-shrink-0 flex items-center justify-center w-5 h-5 rounded-full bg-[var(--terra)]/10 text-[var(--terra)] text-[11px] font-bold mt-0.5",children:x}),e.jsx("p",{className:"flex-1 text-[15px] leading-relaxed opacity-90",children:m(u.join(".").trim())})]},i)}return c?e.jsxs("div",{className:"flex gap-2.5 pl-2 my-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-[var(--ink)]/40 mt-2 flex-shrink-0"}),e.jsx("p",{className:"flex-1 text-[15px] leading-relaxed opacity-90",children:m(l.replace(/^[-‚Ä¢]\s+/,""))})]},i):e.jsx("p",{className:"text-[15px] leading-relaxed opacity-90",children:m(s)},i)})})}),T=n.memo(function({msg:t}){const r=t.role==="user";return e.jsxs(d.div,{variants:q,initial:"hidden",animate:"visible",className:`flex gap-3 ${r?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`w-9 h-9 rounded-full flex-shrink-0 flex items-center justify-center shadow-sm mt-auto border border-[var(--border)] ${r?"bg-[var(--terra)] border-transparent text-white":"bg-[var(--card)] text-[var(--terra)]"}`,children:r?e.jsx(z,{size:16}):e.jsx(E,{size:16})}),e.jsx("div",{className:`max-w-[85%] px-5 py-3.5 shadow-sm ${r?"bg-[var(--terra)] text-white rounded-[24px] rounded-br-none":"bg-[var(--card)] text-[var(--ink)] border border-[var(--border)] rounded-[24px] rounded-bl-none"}`,children:r?e.jsx("p",{className:"text-[15px] leading-relaxed whitespace-pre-wrap",children:t.content}):e.jsx(A,{content:t.content})})]})}),D=n.memo(function(){return e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-3 items-center",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-[var(--card)] border border-[var(--border)] flex items-center justify-center",children:e.jsx(j,{size:18,className:"text-[var(--ink-muted)]"})}),e.jsx("div",{className:"bg-[var(--card)] px-4 py-3 rounded-[24px] rounded-bl-none border border-[var(--border)] shadow-sm",children:e.jsx("div",{className:"flex gap-1.5 h-5 items-center",children:[0,1,2].map(t=>e.jsx(d.div,{animate:{y:[0,-4,0]},transition:{repeat:1/0,duration:.6,delay:t*.15},className:"w-1.5 h-1.5 bg-[var(--ink-muted)] rounded-full"},t))})})]})}),F=n.memo(function({hasApiKey:t,onQuickPrompt:r}){return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[80%] text-center px-4",children:[e.jsx(d.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300,delay:.1},className:"w-20 h-20 rounded-[2rem] bg-gradient-to-br from-[var(--terra)] to-[var(--honey)] flex items-center justify-center mb-6 shadow-xl shadow-[var(--terra)]/20",children:e.jsx(j,{className:"w-10 h-10 text-white",strokeWidth:1.5})}),e.jsx(d.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"font-serif text-2xl font-bold text-[var(--ink)] mb-2",children:"Bonjour !"}),e.jsxs(d.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-[var(--ink-muted)] mb-10 max-w-[260px] leading-relaxed",children:["Je suis ton coach personnel. ",e.jsx("br",{}),"De quoi veux-tu parler aujourd'hui ?"]}),e.jsx("div",{className:"w-full max-w-sm space-y-3",children:R.map((s,i)=>e.jsxs(d.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.25+i*.05},onClick:()=>r(s.text),disabled:!t,className:"w-full p-4 bg-[var(--card)] border border-[var(--border)] rounded-[20px] text-left text-[var(--ink)] flex items-center gap-4 hover:border-[var(--terra)]/50 hover:shadow-md transition-all disabled:opacity-50 active:scale-[0.98]",children:[e.jsx("span",{className:"text-xl bg-[var(--bg)] w-10 h-10 rounded-full flex items-center justify-center",children:s.icon}),e.jsx("span",{className:"font-medium text-[15px]",children:s.text})]},s.text))}),!t&&e.jsx("p",{className:"mt-8 text-xs font-medium text-amber-600 bg-amber-50 px-3 py-1 rounded-full border border-amber-100",children:"‚ö†Ô∏è Cl√© API manquante dans les r√©glages"})]})});function Q({messages:o,isLoading:t,onSendMessage:r,hasApiKey:s,getWeeklySummaryPrompt:i,getMotivationPrompt:l,getBreathingExercisePrompt:h}){const[c,m]=n.useState(""),x=n.useRef(null),{safeInsets:u,getBottomPadding:p}=B(),b=p(12),y=u.bottom+50;n.useEffect(()=>{requestAnimationFrame(()=>{x.current?.scrollIntoView({behavior:"smooth"})})},[o.length,t]);const g=n.useCallback(a=>{a.preventDefault();const v=c.trim();v&&!t&&(r(v),m(""))},[c,t,r]),N=n.useCallback(a=>{m(a.target.value)},[]),w=n.useCallback(a=>{r(a)},[r]),k=[{icon:I,label:"R√©sum√©",getPrompt:i},{icon:W,label:"Boost",getPrompt:l},{icon:$,label:"Respirer",getPrompt:h}],f=c.trim().length>0&&!t&&s;return e.jsxs("div",{className:"flex flex-col h-full bg-[var(--bg)] relative overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 space-y-6 scroll-smooth no-scrollbar",children:o.length===0?e.jsx(F,{hasApiKey:s,onQuickPrompt:w}):e.jsxs("div",{className:"space-y-6 pb-4",children:[o.map(a=>e.jsx(T,{msg:a},a.id)),t&&e.jsx(D,{}),e.jsx("div",{ref:x,className:"h-4"})]})}),e.jsxs("div",{className:"flex-shrink-0 z-20 relative",children:[e.jsx("div",{className:"absolute inset-x-0 top-0 bg-[var(--bg)]/95 backdrop-blur-xl border-t border-[var(--border)]",style:{bottom:`-${y}px`}}),e.jsxs("div",{className:"relative",children:[s&&!t&&e.jsx("div",{className:"flex items-center gap-2 px-4 pt-3 pb-2 overflow-x-auto no-scrollbar",children:k.map(a=>e.jsxs("button",{onClick:()=>r(a.getPrompt()),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border text-xs font-semibold whitespace-nowrap active:scale-95 transition-transform bg-[var(--card)] border-[var(--border)] text-[var(--ink)]",children:[e.jsx(a.icon,{size:12,className:"text-[var(--ink-muted)]"}),a.label]},a.label))}),e.jsx("div",{className:"px-3 pt-1",style:{paddingBottom:`${b}px`},children:e.jsxs("form",{onSubmit:g,className:"flex items-end gap-2 bg-[var(--card)] border border-[var(--border)] rounded-[26px] p-1.5 shadow-sm focus-within:ring-2 focus-within:ring-[var(--terra)]/20 transition-shadow",children:[e.jsx("input",{type:"text",value:c,onChange:N,placeholder:t?"L'IA r√©fl√©chit...":"√âcris ton message...",disabled:!s||t,className:"flex-1 pl-4 py-3 bg-transparent text-[var(--ink)] placeholder:text-[var(--ink-muted)]/60 text-[16px] focus:outline-none min-w-0",autoComplete:"off"}),e.jsx("button",{type:"submit",disabled:!f,className:`w-11 h-11 rounded-full flex items-center justify-center flex-shrink-0 transition-all active:scale-90 ${f?"bg-[var(--terra)] text-white shadow-md":"bg-[var(--sand)] text-[var(--ink-muted)]"}`,children:t?e.jsx("div",{className:"w-5 h-5 border-2 border-[var(--ink-muted)] border-t-transparent rounded-full animate-spin"}):e.jsx(P,{size:20})})]})})]})]})]})}export{Q as AIChat};
